<!DOCTYPE html>
<html lang="sq" itemscope itemtype="http://schema.org/WebPage">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, minimal-ui">
    <title>PlayTV | Shiko TV Online - Dokumentar√´, Sport, Filma, Seri, F√´mij√´, Lajme, Muzik√´.</title>
    <meta name="description" content="Shiko TV Online - Dokumentar√´, Sport, Filma, Seri, F√´mij√´, Lajme, Muzik√´.">
    <meta name="author" content="Abraham Carvalho">
    <meta name="generator" content="Shiko TV Online">
    <meta property="og:type" content="website">
    <meta property="og:title" content="PlayTV">
    <meta property="og:description" content="Shiko TV Online - Dokumentar√´, Sport, Filma, Seri, F√´mij√´, Lajme, Muzik√´.">
    <meta property="og:url" content="http://pltv.com.br">
    <meta property="og:image" content="http://pltv.com.br/assets/images/social.png">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="PlayTV">
    <meta property="twitter:description" content="Shiko TV Online - Dokumentar√´, Sport, Filma, Seri, F√´mij√´, Lajme, Muzik√´.">
    <meta property="twitter:url" content="http://pltv.com.br">
    <meta property="twitter:image" content="http://pltv.com.br/assets/images/social.png">
    <meta itemprop="name" content="PlayTV">
    <meta itemprop="description" content="Shiko TV Online">
    <meta itemprop="image" content="http://pltv.com.br/assets/images/social.png">
    <link href="assets/images/touch/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
    <link href="assets/images/touch/favicon-32x32.png" rel="icon" type="image/png" sizes="32x32">
    <link href="assets/images/touch/favicon-194x194.png" rel="icon" type="image/png" sizes="194x194">
    <link href="assets/images/touch/android-chrome-192x192.png" rel="icon" type="image/png" sizes="192x192">
    <link href="assets/images/touch/favicon-16x16.png" rel="icon" type="image/png" sizes="16x16">
    <link href="assets/images/touch/safari-pinned-tab.svg" rel="mask-icon" color="#28324e">
    <link href="manifest.json" rel="manifest">
    <meta name="msapplication-TileColor" content="#28324e">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="msapplication-config" content="browserconfig.xml">
    <meta name="msapplication-TileImage" content="assets/images/touch/mstile-144x144.png">
    <meta name="theme-color" content="#28324e">
    <meta name="application-name" content="PlayTV">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="date=no">
    <meta name="format-detection" content="email=no">
    <meta name="format-detection" content="address=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-title" content="PlayTV">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="skype_toolbar" content="skype_toolbar_parser_compatible">
    <link href="assets/stylesheets/application.css" rel="stylesheet">
    <!-- Shto stile baz√´ n√´se application.css mungon -->
    <style>
        body { font-family: Arial, sans-serif; margin: 0; background: #1a1a2e; color: #fff; }
        .hide { position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .header { background: rgba(0,0,0,0.8); padding: 15px 0; position: sticky; top: 0; z-index: 100; }
        .header__content { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .header__logo { width: 120px; height: 30px; fill: #fff; }
        .header__search { position: relative; width: 300px; }
        .header__search-input { width: 100%; padding: 10px 40px 10px 15px; border-radius: 25px; border: 2px solid #4cc9f0; background: rgba(255,255,255,0.1); color: #fff; }
        .header__menu-list { display: flex; list-style: none; padding: 0; margin: 0; overflow-x: auto; gap: 10px; }
        .header__menu-item { background: rgba(255,255,255,0.1); border: none; color: #fff; padding: 10px 20px; border-radius: 25px; cursor: pointer; }
        .header__menu-item.active { background: #4cc9f0; color: #000; font-weight: bold; }
        .channels { padding: 40px 0; }
        .channels__list { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 25px; padding: 20px 0; }
        .channel-card { background: rgba(255,255,255,0.05); border-radius: 15px; overflow: hidden; transition: transform 0.3s ease; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); padding: 15px; }
        .channel-card:hover { transform: translateY(-5px); border-color: #4cc9f0; }
        .channel-card__image { font-size: 48px; text-align: center; margin-bottom: 10px; }
        .channel-card__title { margin: 0 0 10px 0; font-size: 18px; }
        .channel-card__category { display: inline-block; background: rgba(76,201,240,0.2); color: #4cc9f0; padding: 4px 12px; border-radius: 15px; font-size: 12px; margin-bottom: 10px; }
        .channel-card__description { color: rgba(255,255,255,0.7); font-size: 14px; line-height: 1.4; margin: 0 0 10px 0; }
        .play-button { background: #4cc9f0; color: #000; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; width: 100%; }
        .remodal { background: rgba(0,0,0,0.9); border-radius: 20px; max-width: 800px; }
        .modal__content { padding: 20px; text-align: center; }
        #video-player { width: 100%; max-height: 70vh; border-radius: 10px; }
        .footer { background: rgba(0,0,0,0.9); padding: 30px 0; text-align: center; margin-top: 50px; }
        .footer__logo { width: 100px; height: 25px; fill: #fff; opacity: 0.7; }
        @media (max-width: 768px) {
            .header__content { flex-direction: column; gap: 15px; }
            .header__search { width: 100%; }
            .channels__list { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        }
    </style>
    <script type="application/ld+json">
      {
        "@context": "http://www.schema.org",
        "@type": "WebSite",
        "name": "PlayTV",
        "alternateName": "PlayTV",
        "url": "http://pltv.com.br"
      }
    </script>
</head>
<body>
    <h1 class="hide">PlayTV - Shiko TV Online</h1>
    <header class="header">
        <div class="container">
            <div class="header__content">
                <svg class="header__logo">
                    <use xlink:href="#logo"></use>
                </svg>
                <div class="header__search">
                    <input class="header__search-input" type="search" placeholder="K√´rko kanale...">
                    <svg class="header__search-icon">
                        <use xlink:href="#icon-search"></use>
                    </svg>
                </div>
            </div>
            <nav class="header__menu">
                <ul class="header__menu-list">
                    <li><button class="header__menu-item active" data-filter="*">T√´ gjitha</button></li>
                    <li><button class="header__menu-item" data-filter="dokumentare">Dokumentar√´</button></li>
                    <li><button class="header__menu-item" data-filter="sport">Sport</button></li>
                    <li><button class="header__menu-item" data-filter="filma">Filma & Seri</button></li>
                    <li><button class="header__menu-item" data-filter="femije">F√´mij√´</button></li>
                    <li><button class="header__menu-item" data-filter="lajme">Lajme</button></li>
                    <li><button class="header__menu-item" data-filter="muzike">Muzik√´</button></li>
                </ul>
            </nav>
        </div>
    </header>
    <main>
        <section class="channels" aria-label="Lista e kanaleve">
            <h2 class="hide">Kanale TV n√´ dispozicion</h2>
            <div class="container">
                <div class="channels__list">
                    <!-- Kanale do t√´ ngarkohen k√´tu nga JavaScript -->
                </div>
            </div>
        </section>
    </main>
    <div class="remodal modal" data-remodal-id="modal" data-remodal-options="hashTracking: false, closeOnOutsideClick: false">
        <div class="modal__close" data-remodal-action="close" aria-label="Mbyll">
            <svg class="modal__close-icon">
                <use xlink:href="#icon-close"></use>
            </svg>
        </div>
        <div class="modal__content" id="modal-content">
            <!-- Video player do t√´ vendoset k√´tu -->
        </div>
    </div>

    <!-- SVG Ikonat -->
    <svg xmlns="http://www.w3.org/2000/svg" class="hide">
        <symbol id="logo" viewBox="0 0 44.24 10.41">
            <path d="M1.44,5.93v2.2H0V1.75H2.25q2.41,0,2.41,2A2,2,0,0,1,4,5.34a2.74,2.74,0,0,1-1.85.59Zm0-3.08v2H2q1.15,0,1.15-1T2,2.86Z"/>
            <path d="M9.4,8.13H5.6V1.75H7V7H9.4Z"/>
            <path d="M16.07,8.13H14.5L14,6.71H11.78l-.45,1.42H9.77l2.32-6.38h1.7ZM13.72,5.61,13,3.47a2.79,2.79,0,0,1-.11-.57h0a2.41,2.41,0,0,1-.11.56l-.69,2.16Z"/>
            <path d="M21,1.75,18.91,5.86V8.13H17.47V5.89l-2-4.14h1.64l1,2.38s.07.22.15.52h0a2.32,2.32,0,0,1,.14-.5l1-2.4Z"/>
            <path d="M27,.87A4.34,4.34,0,0,1,30.57,7l.75.44A5.21,5.21,0,0,0,27,0ZM22.66,7A4.34,4.34,0,0,1,26.18.87V0a5.21,5.21,0,0,0-4.27,7.42Zm7.47.75a4.32,4.32,0,0,1-7,0l-.76.44a5.19,5.19,0,0,0,8.55,0Zm-3.52-6A3.48,3.48,0,1,0,30.09,5.2,3.47,3.47,0,0,0,26.61,1.72ZM25.75,6.5V3.89l2.6,1.37Z"/>
            <path d="M37.8,2.92H36V8.13H34.54V2.92H32.73V1.75H37.8Z"/>
            <path d="M44.24,1.75,42,8.13H40.41L38.24,1.75h1.55l1.33,4.44a3.16,3.16,0,0,1,.13.64h0a3.59,3.59,0,0,1,.14-.65l1.32-4.42Z"/>
        </symbol>
        <symbol id="icon-close" viewBox="0 0 15.642 15.642">
            <path d="M8.882,7.821l6.541-6.541c0.293-0.293,0.293-0.768,0-1.061  c-0.293-0.293-0.768-0.293-1.061,0L7.821,6.76L1.28,0.22c-0.293-0.293-0.768-0.293-1.061,0c-0.293,0.293-0.293,0.768,0,1.061  l6.541,6.541L0.22,14.362c-0.293,0.293-0.293,0.768,0,1.061c0.147,0.146,0.338,0.22,0.53,0.22s0.384-0.073,0.53-0.22l6.541-6.541  l6.541,6.541c0.147,0.146,0.338,0.22,0.53,0.22c0.192,0,0.384-0.073,0.53-0.22c0.293-0.293,0.293-0.768,0-1.061L8.882,7.821z"/>
        </symbol>
        <symbol id="icon-search" viewBox="0 0 56.966 56.966">
            <path d="M55.146,51.887L41.588,37.786c3.486-4.144,5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,14.208c0.571,0.593,1.339,0.92,2.162,0.92c0.779,0,1.518-0.297,2.079-0.837C56.255,54.982,56.293,53.08,55.146,51.887z M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17s-17-7.626-17-17S14.61,6,23.984,6z"/>
        </symbol>
    </svg>

    <footer class="footer">
        <div class="container">
            <svg class="footer__logo">
                <use xlink:href="#logo"></use>
            </svg>
            <p style="color: rgba(255,255,255,0.5); margin-top: 10px; font-size: 14px;">¬© 2024 PlayTV</p>
        </div>
    </footer>

    <!-- Bibliotekat kryesore - SHTUAR -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <!-- M3U Parser - Shum√´ e r√´nd√´sishme! -->
    <script src="https://cdn.jsdelivr.net/npm/m3u8-parser@latest/dist/m3u8-parser.min.js"></script>

    <!-- Kodi kryesor i aplikacionit - I P√ãRDIT√ãSUAR -->
    <script>
    $(function() {
        console.log('[PlayTV] Duke startuar...');

        // 1. NGARKO LIST√ãN M3U DHE SHFAQ KANALET
        // ========================================
        function loadPlaylist() {
            $.get('play.m3u') // SIGUROHU q√´ skedari 'play.m3u' ekziston n√´ t√´ nj√´jtin drejtor
                .done(function(m3uText) {
                    console.log('[PlayTV] Lista M3U u ngarkua.');
                    try {
                        const channels = parseM3UFile(m3uText);
                        displayChannels(channels);
                        setupFiltering(channels);
                    } catch (error) {
                        console.error('[PlayTV] Gabim n√´ p√´rpunimin e list√´s:', error);
                        $('.channels__list').html('<p class="error">‚ùå Lista e kanaleve d√´shtoi t√´ ngarkohej.</p>');
                    }
                })
                .fail(function() {
                    console.error('[PlayTV] Skedari M3U nuk u gjet.');
                    $('.channels__list').html('<p class="error">‚ùå Skedari "play.m3u" nuk u gjet. Krijo nj√´ skedar me k√´t√´ em√´r.</p>');
                });
        }

        // 2. FUNKSION P√ãR T√ã P√ãRPROCESUAR SKEDARIN M3U
        // ============================================
        function parseM3UFile(m3uText) {
            const lines = m3uText.split('\n');
            const channels = [];
            let currentChannel = {};

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line.startsWith('#EXTINF:')) {
                    // Merr metadata nga linja EXTINF
                    const info = line.substring(8);
                    const commaIndex = info.lastIndexOf(',');
                    const params = info.substring(0, commaIndex);
                    const title = info.substring(commaIndex + 1);

                    currentChannel = {
                        title: title || 'Kanali pa em√´r',
                        url: '',
                        category: 't√´-gjitha',
                        logo: ''
                    };

                    // Nxjerr kategorin√´ nga parametrat
                    const groupMatch = params.match(/group-title="([^"]+)"/);
                    if (groupMatch) currentChannel.category = slugify(groupMatch[1]);

                    const logoMatch = params.match(/tvg-logo="([^"]+)"/);
                    if (logoMatch) currentChannel.logo = logoMatch[1];

                } else if (line && !line.startsWith('#') && currentChannel.title) {
                    // Kjo √´sht√´ URL-ja e transmetimit
                    currentChannel.url = line;
                    channels.push({...currentChannel});
                    currentChannel = {};
                }
            }
            console.log(`[PlayTV] U gjet√´n ${channels.length} kanale.`);
            return channels;
        }

        function slugify(text) {
            return text.toLowerCase()
                .replace(/[√ßc]/g, 'c').replace(/[√´e]/g, 'e')
                .replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
        }

        // 3. SHFAQ KANALET N√ã FAQE
        // ========================
        function displayChannels(channels) {
            let html = '';
            channels.forEach((channel, index) => {
                const categoryClass = channel.category || 'te-gjitha';
                html += `
                    <div class="channel-card ${categoryClass}" data-category="${categoryClass}">
                        <div class="channel-card__image">${getChannelIcon(channel.title)}</div>
                        <div class="channel-card__content">
                            <h3 class="channel-card__title">${channel.title}</h3>
                            <span class="channel-card__category">${getCategoryName(channel.category)}</span>
                            <p class="channel-card__description">Shiko ${channel.title} live.</p>
                            <button class="play-button" data-url="${channel.url}" data-title="${channel.title}">‚ñ∂ Shiko Tani</button>
                        </div>
                    </div>
                `;
            });
            $('.channels__list').html(html);
            attachPlayEvents();
        }

        function getChannelIcon(name) {
            const icons = {
                'top': '‚≠ê', 'klan': 'üîµ', 'vizion': 'üî¥', 'rtsh': 'üèõÔ∏è',
                'rtk': 'üì°', 'news': 'üì∞', 'sport': '‚öΩ', 'film': 'üé¨',
                'muzik': 'üéµ', 'femij': 'üß∏', 'doc': 'üåç'
            };
            const lower = name.toLowerCase();
            for (const key in icons) {
                if (lower.includes(key)) return icons[key];
            }
            return 'üì∫';
        }

        function getCategoryName(slug) {
            const names = {
                'dokumentare': 'Dokumentar√´', 'sport': 'Sport',
                'filma': 'Filma & Seri', 'femije': 'F√´mij√´',
                'lajme': 'Lajme', 'muzike': 'Muzik√´',
                'te-gjitha': 'T√´ gjitha'
            };
            return names[slug] || slug;
        }

        // 4. LIDH BUTONAT "SHIKO TANI" ME FUNKSIONIN E LUJTJES
        // ===================================================
        function attachPlayEvents() {
            $('.play-button').off('click').on('click', function() {
                const url = $(this).data('url');
                const title = $(this).data('title');
                if (url) {
                    playStream(url, title);
                } else {
                    alert('URL e transmetimit nuk √´sht√´ e disponueshme.');
                }
            });
        }

        // 5. FUNKSIONI KRYESOR P√ãR LUJTJEN E STREAM-IT
        // ===========================================
        window.currentHls = null; // Ruaj instanc√´n aktuale t√´ HLS

        function playStream(streamUrl, channelTitle) {
            console.log(`[PlayTV] Duke luajtur: ${channelTitle}`, streamUrl);

            // Ndalo dhe pastro transmetimin e m√´parsh√´m
            if (window.currentHls) {
                window.currentHls.destroy();
                window.currentHls = null;
            }

            // Krijo elementin video n√´ modal
            const modalContent = $('#modal-content');
            modalContent.html(`
                <h3>${channelTitle}</h3>
                <video id="video-player" controls playsinline></video>
                <p style="color:#aaa; margin-top:10px;">Duke ngarkuar transmetimin...</p>
            `);

            const video = document.getElementById('video-player');
            if (!video) {
                console.error('[PlayTV] Elementi video nuk u krijua.');
                return;
            }

            // P√´rdor HLS.js n√´se mb√´shtetet
            if (Hls.isSupported()) {
                console.log('[PlayTV] Duke p√´rdorur Hls.js');
                const hls = new Hls({
                    enableWorker: true,
                    lowLatencyMode: true,
                    maxBufferLength: 30
                });
                window.currentHls = hls;

                hls.loadSource(streamUrl);
                hls.attachMedia(video);

                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    console.log('[PlayTV] Manifesti u p√´rpunua, duke filluar luajtjen.');
                    video.play().catch(e => {
                        console.warn('[PlayTV] Luajtja automatike u parandalua:', e);
                        modalContent.find('p').text('Kliko butonin Play n√´ video player.');
                    });
                });

                // Menaxho gabimet
                hls.on(Hls.Events.ERROR, function(event, data) {
                    console.error('[PlayTV] Gabim HLS:', data.type, data.details);
                    if (data.fatal) {
                        switch(data.type) {
                            case Hls.ErrorTypes.NETWORK_ERROR:
                                modalContent.find('p').html('‚ùå Probleme me rrjetin. <button onclick="location.reload()">Rifresko faqen</button>');
                                hls.startLoad();
                                break;
                            case Hls.ErrorTypes.MEDIA_ERROR:
                                hls.recoverMediaError();
                                break;
                            default:
                                modalContent.find('p').text('‚ùå Transmetimi nuk √´sht√´ n√´ dispozicion.');
                                hls.destroy();
                                break;
                        }
                    }
                });

            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                // Fallback p√´r Safari
                console.log('[PlayTV] Duke p√´rdorur HLS native (Safari)');
                video.src = streamUrl;
                video.addEventListener('loadedmetadata', function() {
                    video.play();
                });
            } else {
                modalContent.find('p').text('‚ùå Shfletuesi juaj nuk mb√´shtet k√´t√´ lloj transmetimi.');
            }

            // Hap dritaren modale
            $('[data-remodal-id=modal]').remodal().open();
        }

        // 6. FILTRIMI DHE K√ãRKIMI
        // =======================
        function setupFiltering(channels) {
            // Filtro sipas kategorive
            $('.header__menu-item').off('click').on('click', function() {
                const filter = $(this).data('filter');
                $('.header__menu-item').removeClass('active');
                $(this).addClass('active');

                if (filter === '*') {
                    $('.channel-card').show();
                } else {
                    $('.channel-card').hide();
                    $(`.channel-card[data-category="${filter}"]`).show();
                }
            });

            // K√´rko kanale
            $('.header__search-input').on('input', function() {
                const query = $(this).val().toLowerCase();
                $('.channel-card').each(function() {
                    const title = $(this).find('.channel-card__title').text().toLowerCase();
                    $(this).toggle(title.includes(query));
                });
            });
        }

        // 7. STARTIMI I APLIKACIONIT
        // ==========================
        loadPlaylist();

        // Mbyll player-in kur modal mbyllet
        $(document).on('closed', '.remodal', function() {
            if (window.currentHls) {
                window.currentHls.destroy();
                window.currentHls = null;
            }
            const video = document.getElementById('video-player');
            if (video) video.pause();
        });
    });
    </script>

    <!-- Analitikat (mund t√´ hiqet) -->
    <script>
        (function(i,s,o,g,r,a,m){
            i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
            a=s.createElement(o), m=s.getElementsByTagName(o)[0];
            a.async=1; a.src=g; m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-81831559-2', 'auto');
        ga('send', 'pageview');
    </script>
</body>
</html>
